<sect1 id="details.impexp.csv">
<sect1info>
  <author
>&Allan.Anderson;</author>
  <author
>&Jack.H.Ostroff; &Jack.H.Ostroff.mail;</author>
</sect1info>
<title
>Connector Importador de CSV</title>

<sect2
><title
>Raons per a importar fitxers CSV</title>
<para
>En general, és preferible importar OFX. No obstant això, no totes les institucions proporcionen dades en aquest format. Gairebé sempre estaran disponibles els fitxers CSV (valors separats per comes), de vegades es descriuen com a fitxers Excel o de full de càlcul. A més, sovint es poden crear amb força facilitat capturant les dades que voleu importar, com en un fitxer de text, i editant-lo manualment. </para>

<para
>L'enfocament inicial de l'Importador de CSV era gestionar les dades dels extractes bancaris, però també es va afegir la capacitat d'importar alguns extractes d'inversió. A més, després es va millorar per a importar cotitzacions de divises i valors. El codi original es va crear inicialment, abans de convertir-se en un importador de CSV, per a produir fitxers QIF a partir de fitxers CSV, que després es podrien importar. Aquesta capacitat encara està present, però és probable que s'elimini, ja que ara s'enfoca a importar directament fitxers CSV. A més, el &kmymoney; té la capacitat nativa d'<link linkend="details.impexp.qifexp"
>exportar fitxers QIF</link
>, de manera que ja no hi ha cap motiu concret per a produir un fitxer QIF a partir d'un fitxer CSV. </para>
</sect2>

<sect2
><title
>Obtenir el connector</title>
<para
>L'importador de CSV és una de les funcionalitats més noves que s'han afegit al &kmymoney; en forma de connector. No obstant això, igual que amb altres connectors, l'importador de CSV s'inclou amb el codi font del nucli del &kmymoney;, de manera que hauria d'estar disponible en totes les versions de les distribucions &Linux;, així com les versions per a altres plataformes disponibles a través del lloc web del &kmymoney;. L'opció de menú per a importar fitxers CSV hauria de mostrar-se automàticament en el submenú <menuchoice
> <guimenu
>Fitxer</guimenu
> <guisubmenu
>Importa</guisubmenu
> </menuchoice
>. </para>

<para
>Per a assegurar-vos que està habilitat dins del &kmymoney;, comproveu l'element de menú <menuchoice
> <guimenu
>Arranjament</guimenu
> <guimenuitem
>Configura el &kmymoney;...</guimenuitem
> </menuchoice
>, seleccioneu <guilabel
>Connectors</guilabel
> a la subfinestra esquerra i cerqueu l'importador de CSV <guilabel
></guilabel
> a la llista de connectors visualitzada. Si l'importador de CSV no sembla que estigui instal·lat a la versió, el primer lloc per a comprovar-ho serà al mateix lloc on vàreu obtenir el paquet base del &kmymoney;. Vegeu si hi ha disponible una versió posterior o si l'importador està disponible com a un paquet separat. </para>

<para
>Si l'heu construït a partir del codi font, no hi hauria d'haver requisits addicionals. El procés de construcció del &kmymoney; hauria de detectar el codi font del connector i compilar el connector. Hi ha paràmetres de configuració que es poden utilitzar per a excloure aquest o altres connectors de ser construïts, però aquests rarament haurien de ser necessaris. </para>
</sect2>

<sect2
><title
>Importar un fitxer CSV</title>
<para
>Per a importar un fitxer CSV, trieu l'importador des del menú principal: <menuchoice
><guimenu
>Fitxer</guimenu
><guisubmenu
>Importa</guisubmenu
> <guimenuitem
>CSV...</guimenuitem
></menuchoice
>. Si no es mostra CSV sota Importa, el connector Importador de CSV no està instal·lat correctament o no està activat. Consulteu la secció anterior. </para>

<para
>L'importador de CSV es presenta en forma d'assistent, amb una pàgina separada per a cada pas individual del procés. </para>

<sect3
><title
>Assistent de la importació de CSV: Inici</title>
<para
>Quan es llança, l'importador de CSV mostra la pàgina <guilabel
>Inici</guilabel
> o <guilabel
>Fitxer</guilabel
>. A l'esquerra hi ha una llista dels passos del procés d'importació, amb l'actual ressaltat. L'àrea superior dreta és on es mostraran les dades a importar; abans d'això, mostra algunes instruccions breus rellevants per a la fase actual de l'assistent. A continuació es mostra un conjunt de botons de ràdio per a la selecció del tipus de dades a importar. Aquesta llista actualment inclou <guilabel
>Bancs</guilabel
>, <guilabel
>Inversió</guilabel
>, <guilabel
>Cotitzacions de divises</guilabel
> i <guilabel
>Cotitzacions de valors</guilabel
>. A continuació, hi ha un selector desplegable de perfils, que està habilitat una vegada seleccionat el botó d'opció per a un dels tipus de fitxer d'importació. </para>

<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Inici</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_1.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Inici</phrase>
    </textobject>
  </mediaobject>
</screenshot>
</sect3>

<sect3
><title
>Perfils d'importació de CSV</title>
<para
>Cada tipus de fitxer CSV a importar requereix l'especificació de diversos detalls sobre la formatació esperada de les dades, tal com es descriu a les seccions següents. No només els detalls difereixen per als diferents tipus de fitxers de dades importats, és possible que es necessitin configuracions diferents per al mateix tipus de dades de fonts diferents. Per tant, no cal que introduïu tots aquests detalls cada vegada que importeu un fitxer, l'importador de CSV us permet especificar els detalls una vegada, i desar-los en un perfil amb nom. </para>

<para
>El nom d'un perfil d'importació de CSV és completament arbitrari, però serà més fàcil de recordar si reflecteix tant el tipus de dades que s'importen (banc, targeta de crèdit, inversió...) i la font de les dades. No hi ha necessitat de fer referència al compte en el qual s'importen les dades, i és possible utilitzar el mateix perfil per a importar en més d'un compte, com dos comptes corrents en el mateix banc. </para>

<para
>El desplegable del selector de perfils inclou els noms de tots els perfils de l'importador de CSV que heu creat prèviament, i també us permet escriure el nom d'un perfil nou. A sota de la llista desplegable del selector de perfils, hi ha tres botons. Quan feu clic a <guilabel
>Afegeix</guilabel
>, que sempre està activat, es crearà un perfil nou amb el nom introduït al desplegable. No passarà res si aquest camp està buit o si mostra el nom d'un perfil existent. A mesura que procediu a través de la resta de l'assistent de l'importador de CSV, les diverses opcions de configuració que introduïu o modifiqueu es desaran en el perfil seleccionat. </para>

<para
>Si prèviament havíeu creat un o més perfils, s'habilitaran els altres dos botons. Si feu clic a <guilabel
>Elimina</guilabel
>, el perfil anomenat al desplegable s'eliminarà. Si feu clic a <guilabel
>Canvia el nom</guilabel
>, llavors modificareu el nom que es mostra al desplegable, i feu clic a <guilabel
>Canvia el nom</guilabel
> de nou, el perfil es canviarà en conseqüència. </para>

<para
>Al costat del selector de perfils hi ha una casella de selecció <guilabel
>Omet la configuració</guilabel
>. Inicialment, no hauríeu de seleccionar aquesta casella de selecció. Una vegada hàgiu configurat un perfil i hàgiu finalitzat l'assistent, tots els paràmetres de configuració es desaran al fitxer de recursos amb el nom del perfil. La vegada següent que utilitzeu aquest mateix perfil, els paràmetres es carregaran a la interfície d'usuari. L'assistent anirà a través de les pàgines següents de paràmetres que no necessitareu canviar. Per tant, una vegada esteu satisfet amb un perfil, podria ser útil marcar aquest quadre. L'assistent es mourà directament a la pàgina final i, suposant que no es trobin problemes, només haureu de fer clic a <guilabel
>Importa</guilabel
>. </para>

<para
>A la part inferior hi ha un botó <guilabel
>Tria el fitxer</guilabel
>. En fer-hi clic s'obrirà un diàleg de selecció de fitxers que permet triar el fitxer a importar. A la part inferior de les pàgines restants de l'assistent hi ha botons per a anar <guibutton
>&lt; Enrere</guibutton
> al pas anterior de l'assistent, passar al pas <guilabel
>Següent &gt;</guilabel
>, o <guibutton
>Cancel·la</guibutton
> la importació. </para>

<para
>Per a revisar, a la pàgina d'inici de l'assistent, seleccioneu primer la casella de selecció per al tipus de dades que esteu important. Al desplegable del selector de perfils, podeu seleccionar el nom d'un perfil d'importació CSV creat prèviament, o introduir un nom nou, possiblement el nom del compte al qual voleu importar, i feu clic a <guilabel
>Afegeix</guilabel
>. Finalment, feu clic a <guilabel
>Tria el fitxer</guilabel
>, i s'obrirà un diàleg de selecció de fitxers, on seleccionareu el fitxer CSV que voleu importar. </para>
</sect3>

<sect3
><title
>Assistent de la importació de CSV: Separadors</title>
<para
>Després d'obrir el fitxer de dades seleccionat, l'assistent avançarà fins a la pàgina <guilabel
>Separadors</guilabel
>, i hauríeu de veure les dades. </para>

<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Separadors</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_2.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Separadors</phrase>
    </textobject>
  </mediaobject>
</screenshot>

<warning>
  <para
>Podria semblar que les dades que es mostren a la secció superior de la finestra del connector poden editar-se, i de fet es pot, però no es conservarà l'edició. La taula només és per a mostrar, no per a editar. L'importador de CSV no alterarà mai el fitxer d'entrada, i les dades realment importades provenen del fitxer d'entrada, no de la pantalla. L'única excepció a això està coberta en <link linkend="details.impexp.csv.secsym"
>Títols i símbols</link
> a continuació. </para
> 
</warning>

<para
>L'importador de CSV hauria d'haver detectat la <guilabel
>Codificació</guilabel
> apropiada, el <guilabel
>Delimitador de camp</guilabel
> i el <guilabel
>Delimitador de text</guilabel
>. Podeu canviar la codificació si el programa no l'ha triat correctament. Si necessiteu canviar el delimitador de camp, com ara si les dades estan delimitades per tabulacions, i no amb el delimitador de coma, tingueu en compte que si ho feu, es restabliran les opcions de camp que ja hàgiu fet. En general, la cometa (&quot;) és el delimitador de text correcte, però podeu canviar-ho segons sigui necessari. Feu clic a <guibutton
>Següent</guibutton
> per a continuar. </para>
</sect3>

<sect3
><title
>Assistent de la importació de CSV: Files</title>
<para
>Ara estareu a la pàgina <guilabel
>Files</guilabel
> o <guilabel
>Línies</guilabel
>. Aquí, indiqueu si s'ha d'ignorar qualsevol línia al començament o al final del fitxer. </para>

<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Files</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_5.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Files</phrase>
    </textobject>
  </mediaobject>
</screenshot>

<para
>Aquesta pàgina permet ajustar la importació per a ignorar les files de capçalera i peu de pàgina al començament o al final del fitxer, que en realitat no contenen dades a importar. </para>

<formalpara
><title
>Línia inicial</title>
<para
>Establiu això perquè l'importador ometi qualsevol línia de capçalera al fitxer. L'elecció es desarà en aquest perfil per a ús futur. Les línies inicial i final interactuen, i la línia inicial no podrà ser més gran que la línia final, ni tampoc pot ser més gran al nombre real de línies al fitxer. Si el selector de la <guilabel
>Línia inicial</guilabel
> no respon, marqueu l'opció de la línia final. </para>
</formalpara>

<formalpara
><title
>Línia final</title>
<para
>L'importador configurarà això automàticament a l'última línia del fitxer o a l'última configuració desada. Només haureu d'ajustar-ho si hi ha línies de peu de pàgina al fitxer que l'importador hagi d'ignorar. Altrament, és probable que rebeu un avís d'error en les dades quan el connector intenti analitzar les dades incorrectes. De nou, si no respon el selector de <guilabel
>Línia final</guilabel
>, marqueu l'opció de la <guilabel
>Línia inicial</guilabel
>. </para>
</formalpara>

<para
>Per sobre d'aquests dos camps hi ha una casella de selecció <guilabel
>Capçalera que conté el nom del compte o el número</guilabel
>. Si està marcada, l'importador cercarà en les línies de dalt de la línia d'inici el nom del número del compte que s'utilitzarà per a la importació. Si no, se us demanarà aquesta informació. </para>

<para
>Quan estigueu preparat, feu clic a <guilabel
>Següent</guilabel
> per a continuar al pas següent. </para>
</sect3>

<sect3
><title
>Assistent de la importació de CSV: Columnes</title>
<para
>Ara hauríeu d'estar a la pàgina <guilabel
>Columnes</guilabel
>. Aquí és on s'indica a l'importador quines columnes del fitxer contenen les dades que s'assignen als camps específics necessaris per a crear un registre significatiu o una operació, depenent del tipus de dades que s'importa. Hi ha una versió diferent d'aquesta pàgina per a cada tipus de dades, ja que cada un requereix una combinació diferent d'elements. </para>

<sect4
><title
>Assistent de la importació de CSV: Bancs</title>
<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Bancs</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_3.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Bancs</phrase>
    </textobject>
  </mediaobject>
</screenshot>
  
<para
>Per a la majoria de camps, només heu d'utilitzar el desplegable per a seleccionar la columna adequada. Tingueu en compte que molts camps tenen un botó «x» a la dreta. En fer-hi clic s'esborrarà el valor que s'hagi introduït o seleccionat al camp de l'esquerra. A més, hi ha algunes consideracions especials. </para>

<itemizedlist>
<listitem>
  <para
>A la dreta hi ha una àrea amb dues pestanyes. Si el fitxer té una columna única per a tots els valors, seleccioneu la pestanya <guilabel
>Quantitat</guilabel
>. No obstant això, si hi ha columnes separades per a dèbits i crèdits, seleccioneu la pestanya <guilabel
>Dèbit/crèdit</guilabel
>. </para>

  <para
>A la pestanya Quantitat, comenceu seleccionant la columna que conté la quantitat de l'operació. Si hi ha una columna que conté «Crèdit» o «Dèbit» per a indicar quin és l'import, seleccioneu aquesta columna com l'<guilabel
>Indicador dèbit/credit</guilabel
>. Per separat, si hi ha una cadena inclosa en el camp import que indica que la quantitat és un crèdit o un dèbit, introduïu aquesta cadena en el camp apropiat <guilabel
>Indicador</guilabel
>. Finalment, si tot i establir correctament tots els valors anteriors, la quantitat importada s'inverteix del que hauria de ser, marqueu la casella de selecció <guilabel
>Signes contraris</guilabel
>. </para>

  <para
>A la pestanya Dèbit/crèdit, simplement introduïu els números de les columnes amb aquests valors en els camps apropiats. </para>
</listitem>

<listitem>
<para
>És possible seleccionar més d'una columna per al camp Recordatori, fent seleccions consecutives. Les columnes Recordatori ja seleccionades estaran indicades al camp <guilabel
>Columnes de recordatori:</guilabel
>. Si seleccioneu múltiples columnes d'aquesta manera, el seu contingut es concatenarà al camp Recordatori. </para>
</listitem>

<listitem>
<para
>Si voleu triar el mateix número de columna per a dos camps, l'importador us alertarà i esborrarà ambdues seleccions. No obstant això, és possible, si ho voleu, fer servir la mateixa columna als camps <guilabel
>Beneficiari/Descripció</guilabel
> i <guilabel
>Recordatori</guilabel
>. Si seleccioneu una columna per al camp <guilabel
>Beneficiari/Descripció</guilabel
> i després seleccioneu la mateixa columns per al camp <guilabel
>Recordatori</guilabel
>, rebreu un avís que s'han seleccionat columnes duplicades, però us demanarà si voleu continuar. Si ho feu, feu clic a <guibutton
>Sí</guibutton
> i la columna s'utilitzarà per als dos camps. </para>
</listitem>

<listitem>
<para
>Una raó particular per a capturar també el camp Beneficiari/Descripció al camp Recordatori és que el camp Beneficiari/Descripció podria canviar completament a la importació quan el &kmymoney; realitzi la coincidència de les operacions. En seleccionar aquest camp també com Recordatori, es conservaran aquestes dades, d'altra manera es perdrien. </para>
</listitem>
</itemizedlist>

<para
>Si noteu que heu realitzat una elecció incorrecta, simplement canvieu aquesta selecció. Si cal fer diversos canvis, feu clic al botó <guibutton
>Neteja-ho tot</guibutton
> i torneu a començar. </para>

<para
>Un cop s'hagin triat les columnes per a tots els camps necessaris, s'habilitarà el botó <guibutton
>Següent</guibutton
>, i en fer-hi clic s'avançarà en l'assistent. </para>
</sect4>

<sect4
><title
>Assistent de la importació de CSV: Format</title>
<para
>La pàgina següent de l'assistent encara mostra les dades que s'importaran a la part superior, però la secció inferior proporciona tres desplegables. Els valors inicials els estableix el &kmymoney; basant-se en examinar les dades reals. </para>

<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Inversió</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_4.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Inversió</phrase>
    </textobject>
  </mediaobject>
</screenshot>

<para
>El <guilabel
>Símbol decimal</guilabel
> és «auto,» de manera predeterminada que normalment produeix els resultats correctes. Si no, podeu especificar explícitament el «punt» o «coma». </para>

<para
>El <guilabel
>Símbol de milers</guilabel
> s'estableix automàticament, i el camp es pot desactivar si no afectarà els resultats. </para>

<para
>Això s'haurà d'establir segons l'ordre de l'any, mes i dia en les dates del fitxer. Si el connector troba dades incompatibles amb aquesta opció, es queixarà quan intenti importar. No obstant això, si l'opció és incorrecta, però produeix resultats no vàlids sense detectar (com dades sense dies superiors a 12, de manera que es podrien haver alternat el mes i el dia), simplement obteniu dades incorrectes, això es deu al fet que el connector no podrà saber que ha comès un error. En aquest cas, l'error serà obvi al llibre major després de la importació. </para>

<para
>El <guilabel
>Format de data</guilabel
> especifica l'ordre del dia, mes i any i també s'estableix automàticament. No obstant això, en alguns casos, com les dades sense un dia superior a 12, notareu el problema després de la importació. En aquests casos, haureu de repetir la importació i triar l'ordre real dels components de la data. </para>
</sect4>

<sect4
><title
>Assistent de la importació de CSV: Inversió</title>
<para
>Aquesta pàgina és similar a la pàgina <guilabel
>Bancs</guilabel
>, encara que és una mica més complexa. La majoria de les seleccions són força òbvies, però hi ha alguns elements que poden semblar confusos fins que hàgiu completat el procés una o dues vegades. </para>

<screenshot>
  <screeninfo
>Assistent de la importació de CSV: Inversió</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvImporter_4.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Assistent de la importació de CSV: Inversió</phrase>
    </textobject>
  </mediaobject>
</screenshot>

<para>
<itemizedlist>
<listitem>
<para
>Com a la pàgina <guilabel
>Bancs</guilabel
>, podreu seleccionar més d'una columna per al camp Recordatori. </para>
</listitem>

<listitem>
<para
>El selector <guilabel
>Tipus/Acció</guilabel
> és per a identificar la columna que conté el tipus d'acció, com Comprar, Vendre, Dividend, &etc; </para>
</listitem>

<listitem>
<para
>El selector <guilabel
>Fracció del preu</guilabel
> és per a indicar la fracció/multiplicador per a la compatibilitat entre els preus importats i emmagatzemats. Per exemple, si el preu del fitxer d'importació està en centaus, però el compte del &kmymoney; té un preu en dòlars, seleccioneu 0,01. O, si el preu del fitxer de dades del &kmymoney; està en dòlars, i també esteu important el fitxer CSV, seleccioneu 1,0. </para>
</listitem>

<listitem>
<para
>Hi ha dues maneres d'especificar les comissions de les operacions. Si el fitxer té una columna diferent per a les comissions, utilitzeu el selector <guilabel
>Columna de comissió</guilabel
>. Tingueu en compte que en aquesta pàgina, aquest és l'únic camp que inclou explícitament «columna» a l'etiqueta, per a emfatitzar que és per la columna de comissions, no per a cap despesa real. No obstant això, tingueu en compte que la comissió podria haver estat tinguda en compte en el preu. </para>

<para
>Si hi ha una comissió, però és una xifra percentual, en lloc d'un valor especificat, feu clic a la casella de selecció <guilabel
>La comissió és en percentatge</guilabel
>, i introduïu la taxa en tant per cent al camp <guilabel
>Tipus de comissió</guilabel
>. A més, si hi ha una comissió mínima, especifiqueu-la en el camp <guilabel
>Comissió mínima</guilabel
>, que s'activa quan introduïu la taxa de comissió (amb una coma decimal). En aquest punt, fent clic a <guibutton
>Calcula la comissió</guibutton
> s'afegirà una columna a la dreta de la taula anterior, i s'indicarà la comissió calculada per a cada operació. </para>

<para
>Si heu comès un error en introduir la informació de la comissió, fent clic a <guibutton
>Neteja la comissió</guibutton
> es restabliran tots els camps relacionats amb la comissió als seus valors inicials. </para>
</listitem>

<listitem>
<para
>A sota dels selectors de columna hi ha dues àrees per a la identitat del títol. Depenent del corredor o institució financera, el fitxer podria contenir entrades per a només un o per a diversos títols. <itemizedlist>
    <listitem>
      <para
>Si el fitxer conté les operacions per a un títol individual, amb el nom possiblement en una fila de capçalera, el nom s'haurà d'introduir al quadre <guilabel
>Nom del títol</guilabel
>. El nom que introduïu s'afegirà a la llista desplegable per a ús futur. És possible que posteriorment vulgueu eliminar aquest nom de la llista. Si és així, seleccioneu-lo i després feu clic al botó <guilabel
>Oculta el títol</guilabel
>. Això només l'eliminarà d'aquesta llista i no tindrà cap efecte al fitxer principal del &kmymoney;. </para>
    </listitem>

    <listitem>
      <para
>Si el fitxer inclou les operacions per a diversos títols, cadascun s'identificarà pel seu símbol borsari en una columna amb més detalls en una altra columna. Seleccioneu aquestes columnes als selectors <guilabel
>Símbol</guilabel
> i <guilabel
>Detall</guilabel
>. Podria ser que un títol no tingui un símbol oficial, i en aquest cas es podrà inventar un pseudosímbol. Això no és un problema, sempre que identifiqui de forma exclusiva aquest títol al fitxer d'importació. De vegades, el tipus d'activitat real estarà incrustat a la columna de detalls, possiblement precedit per un text estàndard. Per exemple, si el camp conté «tipus: dividend», aneu al quadre de text <guilabel
>Filtre</guilabel
> i introduïu-hi «tipus: » incloent l'espai final. </para>
    </listitem>
  </itemizedlist>
</para>
</listitem>
</itemizedlist>
</para>

<para
>Quan se seleccionin tots els camps obligatoris, s'habilitarà el botó <guibutton
>Següent</guibutton
>, i en fer-hi clic s'avançarà en l'assistent. </para>
</sect4>

<sect4 id="details.impexp.csv.secsym"
><title
>Assistent de la importació de CSV: Títols i símbols</title>
<para
>Per a un fitxer d'Inversió, una vegada s'hagi acceptat la pàgina <guilabel
>Columnes</guilabel
>, abans que pugueu continuar amb la importació, assegureu-vos que cada títol al fitxer coincideixi amb el títol correcte al fitxer del &kmymoney;. En aquest punt, s'obrirà una altra finestra mostrant els títols i símbols continguts al fitxer d'importació. Recordeu que, a diferència de la visualització de les dades en les finestres principals de l'assistent, els canvis que realitzeu en aquesta pàgina <emphasis
>seran</emphasis
> importants. </para>

<para
>Completar aquesta pàgina és senzill, si teniu en consideració aquests elements: <itemizedlist>
    <listitem>
      <para
>Cada fila representa una operació, de manera que podria semblar que hi ha files duplicades. Això està bé. </para>
    </listitem>

    <listitem>
    <para
>Cada nom de títol haurà de coincidir exactament amb el títol existent com s'especifica al &kmymoney;. Si no coincideix, es crearà com a un títol nou, el qual probablement no voldreu, llevat que representi la compra d'un títol nou. </para>
    </listitem>

    <listitem>
    <para
>S'haurà de mostrar un símbol per a cada títol. </para>
    </listitem>

    <listitem>
    <para
>L'<emphasis
>única</emphasis
> informació en aquesta pàgina haurà de ser el símbol i el nom del títol. Qualsevol altra informació mostrada inicialment (com la data o el tipus d'activitat) encara es trobarà al fitxer real d'importació, però no s'haurà de mostrar aquí. </para>
    </listitem>
  </itemizedlist>
</para>

<para
>Podreu editar un símbol o nom del títol fent doble clic a la cel·la. Per a cada títol, si cal, editeu el nom en una de les seves files. Si apareix el nom correcte del títol al fitxer importat, feu doble clic per a seleccionar-lo, després copieu i enganxeu/editeu, tenint en compte si heu utilitzat una variació o abreujament dins del &kmymoney;. Si editeu un nom de títol, aquesta edició s'aplicarà a totes les files amb el mateix símbol. </para>

<para
>Qualsevol línia sense símbol es tractarà com un element de selecció del tipus de valor. Si alguna operació involucra un altre compte, &pex;, un compte corrent o de valors per a un dividend rebut o per a realitzar un pagament, apareixerà un quadre de missatge perquè introduïu el nom del compte per a la transferència. En general, aquest serà el compte de valors que vàreu triar o crear quan es va crear el compte d'inversió. De la mateixa manera, si se us demana, introduïu el número de columna que conté el beneficiari. Si cometeu un error en introduir el nom del compte, la importació continuarà, però el &kmymoney; no ho reconeixerà i marcarà aquestes operacions com que els hi manca l'assignació de la categoria. Si el nom del compte requerit és massa llarg, introduïu només alguns caràcters. La importació continuarà, però el &kmymoney; marcarà les operacions com que els hi manca l'assignació de la categoria, i haureu de seleccionar el compte correcte per a la transferència després de la importació. Feu clic a <guibutton
>D'acord</guibutton
> quan hàgiu finalitzat. Després s'entregarà el procés d'importació al &kmymoney;. </para>

<para
>Si teniu més d'una operació que es refereix al mateix títol, podreu editar-les totes alhora, utilitzant la selecció múltiple. Per exemple, per a afegir un símbol per a diverses línies, manteniu premuda la tecla &Ctrl; i, a la columna de símbols, seleccioneu cada operació. Mentre la manteniu premuda, totes aquestes cel·les de símbols encara s'hauran de seleccionar, de manera que feu clic sobre una i introduïu el símbol. Feu clic dins de la finestra però fora d'aquesta columna, o premeu &Intro; (no a <guibutton
>D'acord</guibutton
>). Ara que totes aquestes operacions tenen el mateix símbol, feu doble clic en una entrada de detalls i editeu el nom del títol que vulgueu. Feu clic en una altra part de la finestra (o premeu &Intro;) per a acceptar l'edició, el qual canviarà totes aquestes entrades. Les entrades restants mostraran els símbols recollits des de les operacions al fitxer d'importació. </para>

<para
>Ara feu clic a <guibutton
>D'acord</guibutton
>, després a <guibutton
>Importa</guibutton
>. Al quadre <guilabel
>Introduïu un compte</guilabel
>, introduïu el nom d'un compte de valors/compte corrent per a fons. Si introduïu un nom vàlid, s'utilitzarà aquest compte. Si no podeu molestar-vos a introduir un nom correcte però llarg, introduïu alguns caràcters. La importació ho acceptarà, però les operacions del llibre major després de la importació necessitaran un compte adequat per a ser seleccionades. Per al quadre <guilabel
>Valors</guilabel
>, introduïu el número de la columna que conté aquest detall. Ara, al quadre <guilabel
>Operació no vàlida</guilabel
>, podria obtenir algunes entrades perquè el tipus d'activitat no coincideix amb la combinació de quantitat/preu/import. A cada missatge, feu clic a <guilabel
>Selecciona el tipus d'operació</guilabel
>, i apareixerà una llista desplegable indicant els tipus d'activitat vàlids per a aquesta combinació de valors. </para>

<para
>Ara s'ha produït la importació i esteu al &kmymoney; per a seleccionar el compte d'inversió que voleu utilitzar. Després el compte corrent, si hi havia cap operació de valors. </para>
</sect4>

<sect4
><title
>Assistent de la importació de CSV: Cotitzacions de divises</title>
<para
>alguna cosa sobre la importació de cotitzacions de divises </para>
</sect4>

<sect4
><title
>Assistent de la importació de CSV: Cotitzacions de valors</title>
<para
>Alguna cosa sobre importació de cotitzacions de valors </para>
</sect4>
</sect3>

<sect3
><title
>Assistent de la importació de CSV: Final</title>
<para
>En arribar a la pàgina Final, el connector validarà automàticament els valors. Si la/es columna/es de valor numèric està/an ressaltada/es en verd, llavors la validació serà amb èxit i tot el que caldrà és fer clic a <guibutton
>Importa CSV</guibutton
> i el control després passarà al programa principal del &kmymoney;. No obstant això, si les línies inicial i/o final estan configurades incorrectament, o si es varen seleccionar les columnes incorrectes, el ressaltat estarà en vermell i apareixerà un missatge d'error indicant a on es troba l'error. L'usuari haurà de fer clic a <guibutton
>Enrere</guibutton
> per a accedir a la pàgina corresponent per a corregir l'error. </para>

<para
>També podria ser que si les columnes de dèbit i crèdit estan en ús, una d'aquestes columnes legítimament podria no contenir entrades. Això voldrà dir que aquesta columna no té cap símbol decimal present, i això generarà un avís. Si veieu que aquest és el cas, podreu fer clic a qualsevol dels botons per a acceptar (<guibutton
>Accepta això</guibutton
> o <guibutton
>Accepta-ho tot</guibutton
>). </para>
 
<formalpara
><title
>Símbol decimal</title>
<para
>Un altre possible problema podria ser que el símbol decimal seleccionat sigui incorrecte. Per a esborrar aquest error cal seleccionar el símbol perquè coincideixi amb les dades. Normalment, no hauríeu de necessitar canviar aquesta selecció. Recordeu que el símbol decimal s'ha d'establir perquè coincideixi amb el fitxer, no amb la vostra configuració regional. Si la configuració regional té un valor diferent, tindrà lloc la conversió. La visualització del fitxer a la part superior de la finestra mostrarà camps numèrics ressaltats en verd si la configuració actual produeix resultats vàlids, en cas contrari en vermell. El ressaltat també reflectirà les opcions de la <guilabel
>Línia inicial</guilabel
> i la <guilabel
>Línia final</guilabel
>. Hi podrien haver avisos si alguna de les cel·les seleccionades sembla no contenir el símbol seleccionat. </para>
</formalpara>

<formalpara
><title
>Separador de milers</title>
<para
>No cal seleccionar-lo, ja que es configura automàticament en funció del <guilabel
>Símbol decimal</guilabel
>. Es proporciona únicament com una guia. A més, el selector estarà inactiu si cap dels valors a importar és major o igual que 1.000. </para>
</formalpara>

<formalpara
><title
>Importar CSV</title>
<para
>En fer clic en aquest botó, se li indicarà al connector que importi realment les dades des del fitxer, en funció de les seleccions que hàgiu fet anteriorment. El &kmymoney; us demanarà el compte correcte al qual importar les dades. </para>
</formalpara>
</sect3>

<sect3
><title
>Crear un fitxer QIF</title>
<para
>Aquest botó ofereix la possibilitat, una vegada hàgiu completat la importació, de desar les dades del fitxer CSV com un fitxer QIF, en cas que en necessiteu un per qualsevol motiu. Aquesta va ser en realitat la funcionalitat original que va impulsar la creació d'aquest connector. No obstant això, com que el &kmymoney; pot exportar un fitxer QIF, la capacitat ara és de poca utilitat i és probable que amb el temps sigui eliminada. </para>
</sect3>

<sect3
><title
>Finalitzant</title>
<para
>Per a una importació de <guilabel
>Bancs</guilabel
>, el connector haurà finalitzat i el &kmymoney; us demanarà, com s'ha indicat anteriorment, el compte correcte al qual importar les dades. No obstant això, per a una importació d'<guilabel
>Inversió</guilabel
>, es podria requerir una mica més. Si, durant la importació d'una operació, el connector no troba un tipus vàlid d'operació, mostrarà l'operació infractora i l'usuari podrà seleccionar un tipus vàlid per a substituir, segons la combinació dels valors per a quantitat, preu i import. Per a cada operació, el connector validarà el contingut de la columna per a garantir que coincideixi amb el tipus d'acció. Per exemple, si apareix una quantitat però no hi ha preu o import, se suposa que l'operació només podrà ser afegir accions o eliminar les accions. O, si hi ha un import però no hi ha cap quantitat o preu, llavors s'assumirà un Dividend, &etc; </para>

<para
>Si voleu desar les opcions, recordeu fer clic a <guibutton
>Finalitza</guibutton
>, i es tancarà el connector. </para>
</sect3>

<sect3
><title
>Afegir els tipus d'activitat de les inversions</title>
<para
>Si trobeu que els extractes d'inversió segueixen incloent els tipus d'activitat que no s'han reconegut, simplement afegiu-los a la secció al fitxer de recursos. (Vegeu <link linkend="details.impexp.csv.config"
>a continuació</link
> per a obtenir més detalls sobre aquest fitxer). Per exemple, a la secció <literal
>[InvestmentSettings]</literal
> del fitxer, el camp <literal
>BuyParam</literal
> inclourà entrades per a <literal
>Purchase</literal
>, <literal
>Buy</literal
>, <literal
>New Inv</literal
> i <literal
>Switch In</literal
>. Si en trobeu un de diferent, afegiu-lo a la llista correcta i torneu a iniciar el connector. Podríeu notar que hi ha similituds en les entrades en diferents camps, i podríeu trobar que s'està seleccionant el tipus d'activitat incorrecte. El connector comprovarà aquestes llistes en l'ordre següent: <literal
>Shrsin</literal
>, <literal
>DivX</literal
>, <literal
>Reinvdiv</literal
>, <literal
>Brokerage</literal
>, <literal
>Buy</literal
>, <literal
>Sell</literal
> i <literal
>Remove</literal
>. Tornar a ordenar les llistes per a adaptar-les no funciona com podria esperar-se, ja que les entrades al fitxer de recursos s'ordenaran alfabèticament. Si el paràmetre infractor és un que no necessiteu, simplement suprimiu-lo del fitxer. Si això no és possible, possiblement haureu d'editar el fitxer abans d'introduir-lo. </para>
</sect3>

<sect3 id="details.impexp.csv.config"
><title
>Configuració del connector de l'importador de CSV</title>
<para
>Un inconvenient ben conegut del format QIF és que es tracta un format força fluix. Amb els fitxers CSV, hi ha el mateix problema, només que encara més, ja que no existeix un estàndard acordat. Amb els fitxers d'inversió, en particular, hi ha moltes més possibilitats de variació en especificar els diferents tipus d'activitat representats en les dades. El connector ho maneja llistant aquests tipus d'activitat en un fitxer de recursos, anomenat <filename
>csvimporterrc</filename
>. La ubicació d'aquest fitxer dependrà del sistema operatiu o de la distribució. En un sistema &Linux;, aquest estarà a <filename class="directory"
>$KDEHOME/share/config</filename
> on <envar
>$KDEHOME</envar
> generalment és «.config» dins de la carpeta d'inici. Si esteu migrant des d'una versió anterior del &kmymoney; 5.0, la ubicació anterior de <envar
>$KDEHOME</envar
> era <filename class="directory"
>.kde4</filename
>, també dins de la vostra carpeta d'inici. L'ús d'aquest fitxer de recursos permetrà a l'usuari afegir un tipus d'activitat que el desenvolupador no havia trobat. Si el fitxer no existeix quan s'executa l'importador per primera vegada, crearà una versió predeterminada, la qual contindrà algunes de les descripcions més òbvies. </para>

<para
>Es proporcionen diversos fitxers CSV de mostra (a la carpeta <filename class="directory"
>kmymoney/contrib/csvimporter/</filename
> a l'arbre del codi font) amb l'esperança que puguin ajudar. Per exemple, en la mostra d'inversió, un tipus d'activitat és «<literal
>ReInvestorContract Buy : ReInvested Units</literal
>». En el procés de validació, la primera coincidència amb èxit sobre la <literal
>ReInv</literal
> a <literal
>ReInvestorContract Buy</literal
>, de manera que l'operació es classificarà com a <literal
>Reinvdiv</literal
>, tot i que també s'esmenta <literal
>Buy</literal
>. Un altre exemple que s'ha observat és un tipus d'activitat <literal
>Reinvest</literal
> tot i que l'operació no incloïa ni el preu ni l'import, sinó només una quantitat, així que s'haurà de tractar com <literal
>Add Shares</literal
> o <literal
>Shrsin</literal
>. </para>

<para
>Quan es va crear aquest connector, només s'havien vist com a exemples alguns formats d'inversió, i és molt possible que en trobeu algun que no es pugui gestionar correctament. Si el trobeu, envieu-ne un exemple adequat (editant-lo per a eliminar o substituir la informació personal) a la llista d'usuaris &userlist; o a la llista de desenvolupadors &devlist; del &kmymoney;, el desenvolupador farà tot el que pugui per a modificar el connector perquè el gestioni. </para>

<sect4
><title
>Diàleg de configuració de l'importador de CSV</title>
<para
>Finalment, hi ha alguns altres elements que es poden configurar en un diàleg invocat a través del <link linkend="details.settings.plugins.csvimporter"
>Diàleg de configuració de l'importador de CSV</link
>, que es pot invocar des de la pàgina Connectors del diàleg principal de configuració del KMyMoney. Això inclou quins elements es detectaran automàticament per part de l'importador i quin perfil s'utilitzarà si feu que l'importador exporti un fitxer QIF, com s'ha esmentat anteriorment. </para>
</sect4>
</sect3>
</sect2>

<sect2 id="details.impexp.csvexp">
<sect2info>
  <author
>&Jack.H.Ostroff; &Jack.H.Ostroff.mail;</author>
</sect2info>
<title
>Exportador a CSV</title>

<para
>Per a exportar a un fitxer CSV, trieu l'element de menú <menuchoice
> <guimenu
>Fitxer</guimenu
><guisubmenu
>Exporta</guisubmenu
> <guimenuitem
>CSV...</guimenuitem
></menuchoice
>. El diàleg que apareix us dona diverses opcions que controlen les dades que s'exportaran. </para>

<screenshot>
  <screeninfo
>Exportador a CSV</screeninfo>
  <mediaobject>
    <imageobject>
      <imagedata fileref="csvexport.png" format="PNG"/>
    </imageobject>
    <textobject>
      <phrase
>Exportador a CSV</phrase>
    </textobject>
  </mediaobject>
</screenshot>

<para
>Tingueu en compte que un fitxer CSV exportat pot incloure dades d'un sol compte. </para>

<para
>Especifiqueu el nom del fitxer CSV exportat ja sigui introduint el camí complet al camp <guilabel
>Fitxer on s'exportarà</guilabel
>, o fent clic a <guilabel
>Explora</guilabel
> i navegant-hi al diàleg de desament de fitxer. Trieu quin compte voleu exportar amb el desplegable <guilabel
>Compte a exportar</guilabel
>. </para>

<para
>El període de temps de les dades exportades està controlat pels camps de dates <guilabel
>Comença el</guilabel
> i <guilabel
>Acaba el</guilabel
> de l'<guilabel
>Interval de dates</guilabel
>. Els valors predeterminats representen l'interval de dates complet de tot el fitxer de dades, i s'ajusten quan seleccioneu un compte a exportar. </para>

<para
>De manera predeterminada, el <guilabel
>Separador de camps</guilabel
> és una coma, però també podeu triar utilitzar un tabulador o un punt i coma. </para>

<para
>Si marqueu el botó d'opció <guilabel
>Contingut a exportar</guilabel
> <guilabel
>Compte</guilabel
>, llavors les dades exportades seran les operacions del compte especificat i l'interval de dates. No obstant això, si seleccioneu el botó d'opció <guilabel
>Categories</guilabel
>, llavors el fitxer exportat contindrà una fila per a cada categoria que s'ha definit. Per a les categories de nivell superior, es mostra el nom de la categoria, i es mostra una «I» o una «E» per a indicar si la categoria és d'Ingressos o Despeses. Per a categories no de nivell superior, també es mostra la categoria pare. </para>

<para
>L'exportador generarà un conjunt de columnes adequades al tipus de compte que s'exporta. </para>
</sect2>
</sect1>
