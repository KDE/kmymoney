<?xml version="1.0" encoding="UTF-8"?>
<chapter id="details.investments">
<chapterinfo>
  <authorgroup>
    <author
>&Ace.Jones; &Ace.Jones.mail; </author>
    <author
><personname
><firstname
>Michael</firstname
><surname
>Carpino</surname
></personname
> <email
>mfcarpino@gmail.com</email
> </author>
    <author
>&Jack.H.Ostroff; &Jack.H.Ostroff.mail; </author>
  </authorgroup>
  <date
>30 декабря 2019 г.</date>
  <releaseinfo
>5.0.7</releaseinfo>
</chapterinfo>

<title
>Инвестиции</title>

<sect1 id="details.investments.overview">
<title
>Инвестиции в &kmymoney;</title>

<sect2>
<title
>Инвестиции</title>

<para
>Грубо говоря, инвестиция — это любое размещение денежных средств в расчёте на будущую прибыль. Инвестиционные счета &kmymoney; предназначены для одного определённого вида инвестиций: ценных бумаг. Ценная бумага — инструмент инвестирования, который продаётся или покупается на торговой площадке с целью получения прибыли за счёт повышения курсовой стоимости или дохода в виде процентов или дивидендов. Акции и паевые фонды — самые распространённые ценные бумаги, для них в приложении &kmymoney; предусмотрена специальная поддержка. Облигации имеют другую финансовую структуру, но обычно с ними также возможно работать в &kmymoney;. Фьючерсы, финансовые инструменты, опционы и более сложные инвестиционные инструменты (например, деривативы) также относятся к инвестициям, но в &kmymoney; не предусмотрен специальный функционал для работы с ними. Если инвестиция по своим характеристикам похожа на акцию или паевой фонд, её возможно отслеживать. </para>
</sect2>

<sect2>
<title
>Базовая валюта</title>
<para
>У каждой ценной бумаги имеется базовая валюта. Это валюта, в которой она продаётся или покупается. Когда для инвестиции указывается котировка, её значение всегда высчитывается в базовой валюте. Акция на Нью-Йоркской фондовой бирже (NYSE) котируется в долларах США (USD), а акция на австралийской торговой площадке — в австралийских долларах (AUD). Базовая валюта ценной бумаги не обязательно совпадает со стандартной валютой инвестиционного счёта, на котором хранятся данные этой ценной бумаги. </para>
</sect2>

<sect2 id="details.investments.accounts">
<title
>Инвестиционные счета</title>
<para
>В записи инвестиционного счёта содержатся данные по набору ценных бумаг. Также здесь содержатся данные по операциям, в частности, покупке и продаже ценных бумаг, дивидендам, повторным инвестициям, разбивкам и доходу от этих инвестиций. Все операции в инвестиционном счете должны касаться отдельной инвестиции. </para>

<para
>Счёт в брокерском учреждении обычно содержит и ценные бумаги, и денежные средства. В &kmymoney; инвестиционный счёт содержит <emphasis
>только</emphasis
> ценные бумаги. Он не может содержать денежные средства. Это решение было принято при добавлении инвестиционных счетов в &kmymoney;. Возможно, оно изменится в одной из будущих версий приложения. На данный момент для денежных средств, предназначенных для покупки ценной бумаги или полученных от операции продажи или выплаты дивидендов, необходимо использовать брокерский счёт. </para>
</sect2>

<sect2 id="details.investments.brokerage">
<title
>Брокерские счета</title>
<para
>Когда инвестиционная операция задействует (для покупки ценной бумаги) или производит (благодаря продаже или дивидендам) денежные средства, она должна быть связана с другим счётом, на котором хранятся деньги. Обычно это текущий счёт. Возможно указать любой подходящий счёт для требующей этого инвестиционной операции.  Тем не менее, в &kmymoney; предусмотрен <emphasis
>брокерский счёт</emphasis
>, также иногда называемый <quote
>счётом денежных средств</quote
>, который используется в качестве счёта по умолчанию для таких операций. </para>

<para
>При создании инвестиционного счёта возможно также создать связанный с ним брокерский счёт. По умолчанию брокерскому счёту присваивается название инвестиционного счёта с добавлением текста «(Брокерский счёт)» в конце. </para>
</sect2>
</sect1>

<sect1 id="details.investments.investment">
<title
>Создание инвестиционного счёта</title>

<para
>Первым этапом работы с инвестициями является создание счёта для хранения данных об определённых ценных бумагах: выберите пункт меню <menuchoice
><guimenu
>Счёт</guimenu
> <guimenuitem
>Новый счёт...</guimenuitem
></menuchoice
>. Создайте счёт (как указано в предыдущем разделе о добавлении <guilabel
>счёта</guilabel
>) и обязательно укажите в поле типа счёта <quote
>Инвестиции</quote
>. </para>

<para
>Для работы с новым инвестиционным счётом перейдите к просмотру области <guibutton
>Инвестиции</guibutton
> и выберите только что созданный счёт в раскрывающемся списке <guilabel
>Выбрать счёт</guilabel
>. </para>
</sect1>

<sect1 id="details.investments.securities">
<title
>Добавление инвестиций к счёту</title>

<para
>Чтобы добавить к инвестиционному счёту отдельные ценные бумаги, перейдите к просмотру области <guibutton
>Инвестиции</guibutton
>, откройте вкладку <guibutton
>Собственный капитал</guibutton
> и выберите инвестиционный счёт, на котором хранятся данные об инвестиции, в поле <guilabel
>Выбрать счёт</guilabel
>. <screenshot>
  <screeninfo
>Область просмотра «Инвестиции», вкладка «Собственный капитал»</screeninfo>
  <mediaobject>
  <imageobject>
  <imagedata fileref="investments_summarytab.png" format="PNG"/>
  </imageobject>
  <textobject>
  <phrase
>Область просмотра «Инвестиции», вкладка «Собственный капитал»</phrase>
  </textobject>
  </mediaobject>
  </screenshot>
</para>

<para
>Щёлкните правой кнопкой мыши по свободному месту в области просмотра. Появится контекстное меню <guimenu
>Действия с инвестициями</guimenu
>. Выберите в этом меню пункт <guimenuitem
>Новая инвестиция...</guimenuitem
>: будет запущен <guilabel
>мастер добавления инвестиций</guilabel
>, с помощью которого возможно создать новую инвестицию. </para>

<sect2 id="details.investments.newinvestmentwizard">
<title
>Мастер добавления инвестиций</title>

<para
>Будет предложено указать тип инвестиции (акция, облигация и так далее). </para>

<para
>Затем появится страница сведений об инвестиции. На ней необходимо указать следующие данные: </para>

<itemizedlist>
  <listitem
><para
>Тикер. Торговый код — это код, который используется для обозначения ценной бумаги на фондовой бирже. В &kmymoney; торговый код требуется для всех ценных бумаг, но для некоторых из них таких кодов нет. В этом случае следует просто самостоятельно придумать код. </para
></listitem>

  <listitem
><para
>Полное имя. Полное название создаваемой инвестиции, например: <quote
>Advanced Micro Devices, Inc.</quote
> Это название также называется ценной бумагой. </para
></listitem>

  <listitem
><para
>Коэффициент. Он обозначает степень точности, с которой измеряется капитал. Например, в США в большинстве паевых фондов стоимость пакетов акций измеряется с точностью до трёх десятичных знаков, поэтому в этом поле следует ввести 1000. Акции часто измеряются только целыми единицами, поэтому для акции возможно указать значение 1. Следует указать то же количество десятичных знаков, которое использует брокерское учреждение для записи данных ценных бумаг пользователя, чтобы обеспечить соответствие сумм операций в &kmymoney;. Использование повышенного уровня точности не вызовет проблем, а вот использование пониженного уровня точности может привести к ошибкам при округлении, которые, в свою очередь, могут помешать &kmymoney; установить точное соответствие с данными брокерского учреждения. </para
></listitem>
  
  <listitem
><para
>Торговая площадка. Место продажи и покупки акции. Это необязательное для заполнения поле предоставляется для удобства пользователя. Эти сведения не используются где-либо ещё в &kmymoney;. </para
></listitem>

  <listitem
><para
>Идентификационный номер. Необязательное поле для указания дополнительной идентификационной информации. Как и в предыдущем случае, эти сведения не используются где-либо ещё. </para
></listitem>

  <listitem
><para
>Валюта. Валюта, которая используется для покупки или продажи этой ценной бумаги на торговой площадке. Обычно это валюта той страны, в пределах которой осуществляется покупка или продажа. Как правило (но не обязательно), она совпадает с валютой по умолчанию, используемой для инвестиционного счёта, содержащего данные об этой ценной бумаге. </para
></listitem>

  <listitem
><para
>Ввод цены. Выберите, следует ли указывать цену как цену за акцию или как общую стоимость всех акций при вводе операции. </para
></listitem>
</itemizedlist>

<para
>Если используются онлайн-котировки, убедитесь, что указанный код точно соответствует коду, который используется в источнике котировок. Сервис Yahoo содержит данные с большинства мировых торговых площадок, но следует обязательно указывать суффикс в конце кодов торговых площадок, отличных от США, чтобы обозначить страну или площадку. Например, код акций Rubicon Limited на фондовом рынке Новой Зеландии следует указывать как <quote
>RBC.NZ</quote
>. </para>

<para
>Наконец, программа откроет диалоговое окно сетевого обновления. С помощью этого диалогового окна возможно указать приложению &kmymoney;, каким образом следует обновлять курс инвестиции. В этом окне возможно настроить следующие параметры: </para>

<itemizedlist>
  <listitem>
    <para
>Использовать модуль Finance::Quote. Этот параметр предназначен для пользователей &gnucash;, которые пользовались этим пакетом для получения котировок. Большинство пользователей могут не включать этот параметр. </para>
  </listitem>

  <listitem>
    <para
>Интернет-источник. Сетевой источник, который следует использовать для этой инвестиции. Наиболее часто используется сервис <quote
>Yahoo</quote
>. Попробуйте воспользоваться этим источником (если же данные не будут найдены, попробуйте использовать другие источники). </para>
  </listitem>

  <listitem>
    <para
>Коэффициент. Множитель, который следует использовать для полученного значения курса инвестиции. Подобный коэффициент прежде всего применяется для ценных бумаг из Великобритании, курсовая стоимость которых определяется в пенсах (1/100), а сами акции имеют стоимость в фунтах. В таком случае введите в поле «Коэффициент» значение 0,01. </para>
  </listitem>
</itemizedlist>
</sect2>

<sect2 id="details.investments.reuse">
  <title
>Использование записи ценной бумаги в нескольких инвестиционных счетах одновременно</title>

<note>
  <para
>Этот раздел был добавлен во время подготовки к выпуску версии 5.0.8. Его задача — включить в руководство по крайней мере основные сведения, поскольку эта тема вызывает определённые сложности. В дальнейшем будет расширена текстовая часть, а также добавлены снимки окон мастера добавления записей ценных бумаг. </para>
</note>
      
<para
>Предусмотрена возможность установления принадлежности пользователю частей одной и той же ценной бумаги на различных инвестиционных счетах, в частности на обычном инвестиционном счете и на пенсионном счете. Если вышеприведённые инструкции были выполнены, записи ценной бумаги появятся на обоих счетах, но &kmymoney; будет обрабатывать их так, как будто у каждой из ценных бумаг своя базовая стоимость. Это приведёт к дублированию данных, включая появление двух копий полного журнала цены актива. Поэтому рекомендуется сделать так, чтобы у обеих частей ценных бумаг была та же базовая стоимость. </para>

<para
>Если в инвестиционный счёт добавляется запись ценной бумаги, которая уже существует в другом инвестиционном счёте, следует использовать ту же запись, а не создавать дубликат. В окне <guilabel
>Мастер добавления инвестиций</guilabel
> после выбора типа инвестиции и нажатия кнопки <guibutton
>Далее</guibutton
> следует убедиться, что в поле <guilabel
>Полное имя</guilabel
> ничего не указано, прежде чем вводить <guilabel
>Тикер</guilabel
>. После нажатия клавиши <keycap
>Tab</keycap
>, если в &kmymoney; уже имеется запись ценной бумаги с этим торговым кодом, будет предложено использовать его. Если нажать кнопку <guibutton
>Да</guibutton
>, программа автоматически заполнит остальные поля диалога, и будет достаточно просто нажать кнопку <guibutton
>Далее</guibutton
>. </para>

</sect2>
</sect1>

<sect1 id="details.investments.edit">
<title
>Редактирование инвестиции</title>

<para
>На вкладке <guilabel
>Собственный капитал</guilabel
> области просмотра «Инвестиции» показан список текущих пакетов акций на счёте, с кодами этих акций, суммами, количеством и ценой. Если навести указатель мыши на любую из этих записей и щёлкнуть правой кнопкой мыши, появится контекстное меню <guimenu
>Действия с инвестициями</guimenu
>, которое содержит пункты, предназначенные для добавления, изменения или удаления отдельных инвестиций со счёта. Также возможно обновить цену инвестиций вручную или с помощью онлайн-источника. Кроме того, возможно закрыть пустой счёт или заново открыть закрытый счёт. Порядок для суммы, количества и цены возможно изменить: наведите указатель мыши на любое из этих полей на верхней панели, нажмите левую кнопку мыши и перетащите соответствующий пункт влево или вправо. </para>
<para
>Если выбрано редактирование инвестиции, будет открыто окно <guilabel
>Мастер детализации инвестиций</guilabel
>, которое выглядит и работает аналогично окну <guilabel
>Мастер добавления инвестиций</guilabel
>, описание которого приводилось в предыдущем разделе. </para>
</sect1>

<sect1 id="details.investments.ledger">
<title
>Инвестиционные операции</title>

<para>
	<screenshot>
	<screeninfo
>Форма ввода инвестиционных операций</screeninfo>
	<mediaobject>
	<imageobject>
	<imagedata fileref="investment-transactionform.png" format="PNG"/>
	</imageobject>
	<textobject>
	<phrase
>Форма ввода инвестиционных операций</phrase>
	</textobject>
	</mediaobject>
	</screenshot>
</para>

<para
>Инвестиционные операции вводятся и редактируются в области просмотра <link linkend="details.ledgers"
>Книга учёта</link
>, как и в случае других записей счетов. Но поля данных будут различаться в зависимости от типа операции или действия. Для инвестиционных операций предусмотрено несколько дополнительных элементов: </para>

<itemizedlist>
	<listitem
><para
>Действие</para
></listitem>
	<listitem
><para
>Ценная бумага</para
></listitem>
	<listitem
><para
>Счёт</para
></listitem>
	<listitem
><para
>Акции, цена, общая сумма</para
></listitem>
	<listitem
><para
>Комиссия</para
></listitem>
	<listitem
><para
>Статья процентов</para
></listitem>
</itemizedlist>

<sect2>
<title
>Действие</title>
<para
>В поле «Действие» инвестиционной операции указывается, какое действие выполняется с ценной бумагой. Поддерживаются следующие действия: </para>

<variablelist>
  <varlistentry>
  <term
>Покупка или продажа</term>
  <listitem>
    <para
>Используется для записи покупки или продажи отдельных ценных бумаг. Для выполнения этого действия требуется счёт для снятия или получения средств. По умолчанию используется брокерский счёт, если он был создан. </para>
  </listitem>
  </varlistentry>

  <varlistentry>
  <term
>Дивиденды или доходность</term>
  <listitem>
    <para
>Это действие также называется <quote
>дивиденды в денежной форме</quote
>. Оно используется при выплате процентов или дивидендов от ценной бумаги. Для выполнения этого действия также требуется счёт для получения средств. </para>
  </listitem>
  </varlistentry>

  <varlistentry>
  <term
>Реинвестирование дивидендов</term>
  <listitem>
    <para
>Реинвестирование дивидендов. Это дивиденды, которые не изымаются, а используются для приобретения дополнительных ценных бумаг. </para>
  </listitem>
  </varlistentry>

  <varlistentry>
  <term
>Добавление или удаление акций</term>
  <listitem>
    <para
>Простое увеличение или уменьшение количества принадлежащих пользователю ценных бумаг. Используется очень редко, поскольку для ценных бумаг является нетипичным появление или исчезновение без непосредственного приобретения или продажи. Эти действия допустимо использовать в тех случаях, когда программа &kmymoney; не обеспечивает автоматическую обработку событий (например, в случае обмена некоторого количества ценных бумаг на другое количество ценных бумаг другого класса той же инвестиции). </para>
  </listitem>
  </varlistentry>

  <varlistentry>
  <term
>Дробление акций</term>
  <listitem>
    <para
>Это действие используется при дроблении акций. Укажите соотношение дробления в поле <quote
>Соотношение</quote
>. Например, при дроблении в соотношении 3:2 следует указать 1,5. Также это действие возможно использовать при консолидации («обратном дроблении») акций: в этом случае соотношение будет меньше единицы (например, 2:3). </para>
  </listitem>
  </varlistentry>
</variablelist>
</sect2>

<sect2>
<title
>Ценная бумага</title>
<para
>Каждая инвестиционная операция должна быть связана с отдельной ценной бумагой. Укажите название ценной бумаги при добавлении или редактировании операции. При её просмотре будет показан код. </para>
</sect2>

<sect2>
<title
>Счёт</title>
<para
>Для любой операции, выполнение которой требует получения или снятия средств, необходимо указать соответствующий счёт. Если с инвестиционным счётом связан брокерский счёт, рекомендуется переводить средства на него. Это применимо к  средствам для приобретения или продажи ценной бумаги, а также к уплачиваемым комиссиям или получаемым процентам или дивидендам. </para>
</sect2>

<sect2>
<title
>Акции, цена, общая сумма</title>
<para
>Для операций покупки, продажи и реинвестирования необходимо указывать количество акций, цену за акцию, а также общую сумму операции. Возможно ввести значения любых двух из этих параметров, и приложение &kmymoney; автоматически рассчитает значение третьего. Рекомендуется просто указать общую сумму и количество акций, так как это известные данные операции. &kmymoney; автоматически рассчитает цену за акцию. Обратите внимание, что для цены предусмотрено только одного поле, которое называется <quote
>Сумма операции</quote
> или <quote
>Цена/акция</quote
> (в зависимости от значения параметра <guilabel
>Ввод цены</guilabel
>, выбранного при <link linkend="details.investments.newinvestmentwizard"
>настройке</link
> счёта). </para>
</sect2>

<sect2>
<title
>Комиссия</title>
<para
>Во многие инвестиционные операции возможно включить комиссию, уплаченную брокеру. Если для комиссии указывается статья, справа от неё будет поле, в которое возможно ввести сумму комиссии. Если требуется указать несколько комиссий для одной операции, возможно использовать функцию <link linkend="details.ledgers.split"
>разбивки операции</link
>. Когда будут указаны данные для всех разбивок, справа будет показана общая сумма комиссий. </para>
</sect2>

<sect2>
<title
>Процент</title>
<para
>Это действие позволяет указать процентную или дивидендную выплату по ценной бумаге. Как и в случае с комиссиями, при указании статьи справа будет доступно поле для ввода суммы. Кроме того, при необходимости возможно воспользоваться функцией разбивки операции. </para>
</sect2>
</sect1>

<sect1 id="details.investments.foreign">
<title
>Работа с зарубежными инвестициями</title>

<para
>В &kmymoney; предусмотрена поддержка различных валют и разновидностей инвестиций. Эти две возможности могут быть использованы совместно, но при этом необходимо особенно внимательно отнестись к созданию записей. При добавлении ценной бумаги обязательно следует указать валюту, которая используется для её покупки или продажи. Она может отличаться от базовой валюты, заданной для файла &kmymoney;, и от валюты по умолчанию для инвестиционного счёта, содержащего данные об акциях, или счёта, содержащего средства для покупки или от продажи. </para>

<para
>Рассмотрим гипотетический случай, когда базовой валютой является доллар США (USD). У пользователя имеется инвестиционный счёт в евро (EUR) и брокерский счёт, также в евро (EUR). На этом инвестиционном счёте пользователь держит акции TietoEnator, стоимость которых определяется в шведских кронах (SEK). </para>

<para
>При вводе параметров операции покупки для этой инвестиции следует использовать SEK в качестве валюты. Если покупаются 100 акций по цене 248,00 SEK, на общую сумму 24800,00 SEK, в полях операции следует указать именно эти значения. </para>

<para>
	<screenshot>
	<screeninfo
>Предупреждение по валюте</screeninfo>
	<mediaobject>
	<imageobject>
	<imagedata fileref="investment-currencywarning.png" format="PNG"/>
	</imageobject>
	<textobject>
	<phrase
>Предупреждение по валюте</phrase>
	</textobject>
	</mediaobject>
	</screenshot>
</para>

<para
>Если средства для покупки переводятся с брокерского счёта, появится предупреждение о том, что выбранная валюта отличается от валюты этого счёта. </para>

<para>
	<screenshot>
	<screeninfo
>Редактор курсов</screeninfo>
	<mediaobject>
	<imageobject>
	<imagedata fileref="investment-exchangerateeditor.png" format="PNG"/>
	</imageobject>
	<textobject>
	<phrase
>Редактор курсов</phrase>
	</textobject>
	</mediaobject>
	</screenshot>
</para>

<para
>По завершении ввода операции будет предложено обновить значение курса для валюты инвестиционного счёта, в рассматриваемом примере: SEK -> EUR. Подробные сведения о диалоговом окне курсов доступны в разделе об <link linkend="details.currencies.prices"
>указании курсов вручную</link
>. </para>

<para
>Затем возможно перейти к брокерскому счёту и увидеть сумму операции в евро: 2254,54 EUR, если обменный курс равняется 11,0000 SEK/EUR. </para>
</sect1>

<sect1 id="details.investments.prices">
<title
>Обновление курсов</title>

<para
>Обновить курс инвестиции возможно двумя способами: указать его вручную или получить из онлайн-источника с помощью &kmymoney;. </para>

<sect2>
<title
>Обновление курса вручную</title>

<para
>Указать курс инвестиции возможно с помощью того же <link linkend="details.currencies.prices"
>редактора курсов</link
>, который используется для настройки валют. </para>
</sect2>

<sect2 id="details.investments.onlinequotes">
<title
>Онлайн-котировки</title>
<para
>&kmymoney; поддерживает загрузку актуальных котировок ценных бумаг и валют из сетевых источников. </para>

<sect3>
<title
>Как работает функция получения котировок из сетевых источников</title>
<para
>По запросу пользователя &kmymoney; выполнит загрузку интернет-страницы, содержащей актуальный курс ценной бумаги. По умолчанию в качестве источника данных используется <ulink url="https://finance.yahoo.com"
>finance.yahoo.com</ulink
> (использовать данные возможно только в соответствии с условиями, установленными этим сайтом). </para>

<para
>При поиске курса в сети используется код ценной бумаги. Следовательно, важно правильно настроить этот код. Сервис Yahoo поддерживает акции с главных мировых площадок, поэтому обычно требуется всего лишь найти правильный код. Например, акциями TietoEnator торгуют на фондовой бирже Стокгольма, соответствующий код Yahoo — TIEN.ST. </para>

<para
>Чтобы найти торговый код ценной бумаги Yahoo, воспользуйтесь опцией поиска кода (<quote
>Symbol Lookup</quote
>) на веб-сайте <ulink url="https://finance.yahoo.com"
>finance.yahoo.com</ulink
>. </para>
</sect3>

<sect3>
<title
>Выбор источника котировок</title>

<para
>Чтобы получить онлайн-котировки, сначала необходимо включить соответствующую опцию <quote
>источника котировок</quote
> для всех ценных бумаг или валют, данные которых следует обновлять. Требуется указать название сервиса, который будет являться источником значений курсов. В &kmymoney; предусмотрено несколько источников. По умолчанию используется сервис Yahoo, этот источник позволяет получить данные для большинства инвестиций и всех валют. </para>

<para
>Чтобы указать источник котировок для инвестиции, перейдите к области просмотра сводной информации об инвестиции счёта, который содержит данные о соответствующий ценной бумаге. Наведите указатель мыши на пункт ценной бумаги, щёлкните правой кнопкой мыши и выберите в контекстном меню пункт  <guimenuitem
>Редактировать инвестицию...</guimenuitem
>: появится окно «Мастер детализации инвестиций». Дважды нажмите в этом окне кнопку <guibutton
>Далее</guibutton
> для перехода к разделу «Обновление через Интернет». Выберите нужный источник в раскрывающемся списке «Интернет-источник». </para>

<para
>Начиная с версии 0.9, приложение &kmymoney; поддерживает использование пакета «Finance::Quote» для получения онлайн-котировок. Такая возможность предусмотрена для удобства пользователей, которые ранее пользовались программой &gnucash; (в которой этот пакет используется по умолчанию). После включения этого параметра появится другой список источников — будут показаны те источники, которые поддерживаются Finance::Quote. Если список пуст, это означает, что пакет не установлен надлежащим образом. Дополнительные сведения доступны на веб-сайте этого пакета <ulink url="http://finance-quote.sourceforge.net"
> http://finance-quote.sourceforge.net</ulink
>. </para>
</sect3>

<sect3>
<title
>Корректировка котировки</title>

<para
>Некоторые интернет-источники предоставляют курсы не в базовой валюте (например, EUR), а в её дробной части (например, в евроцентах). Если использовать подобные данные для определения курсов, суммы инвестиций окажутся ошибочными. </para>

<para
>В этом случае возможно указать коэффициент поправки в поле <guilabel
>Коэффициент</guilabel
>. В приведённом ранее примере такой коэффициент равен 0,01. </para>

<para
>Поле <guilabel
>Коэффициент</guilabel
> становится доступным только после выбора пункта <guibutton
>Источник котировок</guibutton
>. </para>
</sect3>

<sect3>
<title
>Получение котировок</title>

<para
>Обычно котировки ценных бумаг и валют обновляются одновременно. Чтобы открыть диалог получения котировок из Интернета, выберите пункт меню <menuchoice
><guimenu
>Сервис</guimenu
><guimenuitem
>Обновить курсы акций и валют...</guimenuitem
></menuchoice
>. Нажмите кнопку <guibutton
>Обновить всё</guibutton
> для получения котировок всех ценных бумаг и валют в файле &kmymoney;. </para>

<para>
	<screenshot>
	<screeninfo
>Обновление котировок</screeninfo>
	<mediaobject>
	<imageobject>
	<imagedata fileref="investment-onlineupdate.png" format="PNG"/>
	</imageobject>
	<textobject>
	<phrase
>Обновление котировок с помощью Интернета</phrase>
	</textobject>
	</mediaobject>
	</screenshot>
</para>
</sect3>

<sect3>
<title
>Добавление и редактирование источников котировок</title>

<para
>Добавление и редактирование источников рекомендуется выполнять только пользователям, обладающим глубокими техническими познаниями. Это подразумевает умение читать код HTML и создавать сложные регулярные выражения. Если же пользователь не обладает такими знаниями, рекомендуется отправить письмо в список рассылки разработчиков, если ему не подходит ни один из стандартных источников котировок. При этом желательно указать адрес веб-страницы, на которой доступны соответствующие котировки. Кроме того, возможно посоветоваться с участниками форума сообщества KDE (в разделе, посвящённом &kmymoney;), поскольку у них уже может быть решение, отвечающее потребностям пользователя. </para>

<para
>Если пользователь обладает необходимыми знаниями, то принцип работы следующий. Источники котировок доступны в диалоге настройки. Выберите пункт меню <menuchoice
><guimenu
>Настройка</guimenu
><guimenuitem
>Настроить &kmymoney;</guimenuitem
></menuchoice
>. Затем перейдите в раздел <guilabel
>Онлайн котировки</guilabel
>. Возможно отредактировать существующий источник или создать новый. По завершении внесения изменений обязательно нажмите кнопку <guibutton
>Обновить</guibutton
> перед закрытием диалога. Если не сделать этого, изменения не будут сохранены. </para>

<para
>URL-адрес — первое, что следует указать для источника котировок в Интернете. Это та страница, с которой будут загружаться данные. Все источники котировок содержат шаблон подстановки %1, при этом источники курсов валют также содержат шаблон подстановки %2. В случае инвестиций %1 заменяется значением торгового кода. В случае валют %1 заменяется значением базовой валюты, а %2 — значением котируемой валюты. После этого программа получит страницу по соответствующему URL-адресу, удалит все теги HTML (если это указано пользователем), и обработанный таким образом файл будет передан инструменту обработки страниц. </para>

<para
>Обратите внимание, что в качестве URL-адреса также может быть указан исполняемый файл. Все введённые аргументы передаются в этот файл, а стандартный вывод сценария передаётся инструменту обработки страниц. Например, возможно создать сценарий с названием getquote.sh, в котором будет содержаться программа для получения курсов и который будет принимать единственный параметр — торговый код. Тогда URL-адресом будет <quote
>file:/path/to/getquote.sh %1</quote
>. </para>

<para
>Инструмент обработки страниц выполняет поиск торгового кода, даты и курса. Регулярные выражения определяют, как будут извлекаться эти данные. Описание синтаксиса регулярных выражений, которые используются в &kmymoney;, доступно в документации <ulink url="https://doc.qt.io/qt-5/qregexp.html"
>класса QRegExp</ulink
>. В каждом поле регулярного выражения должно быть только одно выражение для поиска, заключённое в круглые скобки. Формат даты сообщает инструменту обработки дат порядок записи года, месяца и дня. Формат даты всегда следует указывать в виде «%x %x %x», где x может принимать значение y (год), m (месяц) или d (день). Инструмент обработки дат выполняет обработку интеллектуально. Строки формата <quote
>%m %d %y</quote
> <quote
>December 31st, 2005</quote
> и <quote
>12/31/05</quote
> будут обработаны одинаково хорошо. Значение лет в двузначном формате считается обозначением лет в диапазоне 1950—2049. </para>
</sect3>
</sect2>
</sect1>

<sect1 id="details.investments.unimplemented">
<title
>Нереализованные возможности</title>

<para
>Инвестиции обладают некоторыми свойствами, работа с которыми ещё не реализована в &kmymoney;. Среди них производные, опционы и фьючерсы. Кроме того, при продаже ценной бумаги &kmymoney; не может определить, какие именно акции были проданы (недавно приобретённые или приобретённые давно), из-за чего невозможно вычислить прибыль от инвестиции. Наконец, программа не содержит данные о специфических для страны требованиях по налоговой отчётности, но это, как правило, возможно исправить, обозначив все статьи, используемые для операций, которые могут быть обложены налогами, как связанные с налогами. </para>
</sect1>
</chapter>
